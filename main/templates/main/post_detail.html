{% extends 'main/base.html' %}

{% block title %}{{ post.title }} â€“ DSST{% endblock %}

{% block content %}
<div class="page-header">
    <div class="container">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-2" style="--bs-breadcrumb-divider-color:rgba(255,255,255,0.5);">
                <li class="breadcrumb-item"><a href="/" style="color:rgba(255,255,255,0.7);">Home</a></li>
                <li class="breadcrumb-item"><a href="/notices/" style="color:rgba(255,255,255,0.7);">Notice Board</a></li>
                <li class="breadcrumb-item active text-white">{{ post.title|truncatechars:40 }}</li>
            </ol>
        </nav>
    </div>
</div>

<section style="padding:60px 0; background:#f8f9fc;">
    <div class="container">
        <div class="row g-4">
            <div class="col-lg-8">
                <div class="card" style="border-radius:16px;">
                    <div class="card-body p-5">
                        <div class="d-flex gap-2 mb-4">
                            <span class="badge badge-{{ post.post_type }}" style="font-size:0.8rem; padding:6px 14px;">{{ post.get_post_type_display }}</span>
                            {% if post.is_pinned %}<span class="badge bg-warning text-dark" style="font-size:0.8rem; padding:6px 14px;"><i class="fas fa-thumbtack me-1"></i>Pinned</span>{% endif %}
                        </div>
                        <h1 style="font-family:'Playfair Display',serif; color:#1a3a6e; font-size:2rem; line-height:1.3; margin-bottom:20px;">{{ post.title }}</h1>
                        <div class="d-flex gap-4 mb-4 pb-4 border-bottom" style="font-size:0.85rem; color:#888;">
                            <span><i class="fas fa-user me-1"></i>{{ post.author.get_full_name|default:post.author.username }}</span>
                            <span><i class="fas fa-calendar me-1"></i>{{ post.created_at|date:"d F Y" }}</span>
                            <span><i class="fas fa-clock me-1"></i>{{ post.created_at|time:"h:i A" }}</span>
                        </div>
                        {% if post.image %}
                        <img src="{{ post.image.url }}" class="img-fluid rounded mb-4" alt="{{ post.title }}" style="width:100%; max-height:400px; object-fit:cover;">
                        {% endif %}
                        <div style="line-height:1.9; color:#444; font-size:1rem;">
                            {{ post.content|linebreaks }}
                        </div>
              {% if post.document %}
<div class="mt-4 p-4 rounded" style="background:#f1f5ff; border:1px solid #dbe5ff;">
    <h6 class="fw-600 mb-3" style="color:#1a3a6e;">
        <i class="fas fa-file-pdf me-2 text-danger"></i>
        Attached Document
    </h6>
    <a href="{{ post.get_document_url }}" target="_blank"
       class="btn btn-danger rounded-pill">
        <i class="fas fa-download me-2"></i>
        Download PDF
    </a>
</div>
{% endif %}
                                                {% if post.updated_at != post.created_at %}
                        <div class="mt-4 pt-4 border-top" style="font-size:0.82rem; color:#999;">
                            <i class="fas fa-edit me-1"></i>Last updated: {{ post.updated_at|date:"d F Y h:i A" }}
                        </div>
                        {% endif %}
                    </div>
                </div>
                <div class="mt-3">
                    <a href="/notices/" class="btn btn-outline-primary rounded-pill"><i class="fas fa-arrow-left me-2"></i>Back to Notice Board</a>
                </div>
            </div>
            <div class="col-lg-4">
                <!-- Share -->
                <div class="card mb-4" style="border-radius:16px;">
                    <div class="card-body p-4">
                        <h6 class="fw-600 mb-3">Share This Notice</h6>
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-primary flex-fill" onclick="copyLink()"><i class="fas fa-link me-1"></i>Copy Link</button>
                            <a href="https://wa.me/?text={{ post.title }}" target="_blank" class="btn btn-sm btn-success flex-fill"><i class="fab fa-whatsapp me-1"></i>WhatsApp</a>
                        </div>
                    </div>
                </div>
                <!-- Quick Links -->
                <div class="card mb-4" style="border-radius:16px;">
                    <div class="card-body p-4">
                        <h6 class="fw-600 mb-3">Quick Links</h6>
                        <a href="/fee-payment/" class="btn btn-warning w-100 mb-2 rounded-pill"><i class="fas fa-credit-card me-2"></i>Pay Fees Online</a>
                        <a href="/notices/?type=exam" class="btn btn-outline-danger w-100 mb-2 rounded-pill">Exam Notices</a>
                        <a href="/notices/?type=result" class="btn btn-outline-success w-100 rounded-pill">View Results</a>
                    </div>
                </div>
                <!-- Related Posts -->
                {% if related_posts %}
                <div class="card" style="border-radius:16px;">
                    <div class="card-body p-4">
                        <h6 class="fw-600 mb-3">Related Notices</h6>
                        {% for rel in related_posts %}
                        <a href="/notices/{{ rel.pk }}/" style="text-decoration:none; color:inherit;">
                            <div class="p-3 rounded mb-2" style="background:#f8f9fc; transition:all 0.2s;" onmouseover="this.style.background='#e8f4fd'" onmouseout="this.style.background='#f8f9fc'">
                                <div style="font-size:0.85rem; font-weight:600; line-height:1.4;">{{ rel.title }}</div>
                                <div style="font-size:0.78rem; color:#999; margin-top:4px;"><i class="fas fa-calendar me-1"></i>{{ rel.created_at|date:"d M Y" }}</div>
                            </div>
                        </a>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
function copyLink() {
    navigator.clipboard.writeText(window.location.href).then(() => {
        alert('Link copied to clipboard!');
    });
}
</script>
{% endblock %}
